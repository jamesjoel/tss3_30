(function(q){var t=window.AmazonUIPageJS||window.P,m=t._namespace||t.attributeErrors,h=m?m("BuyBackAssets",""):t;h.guardFatal?h.guardFatal(q)(h,window):h.execute(function(){q(h,window)})})(function(q,t,m){q.when("A","ready","BBPageState","bbMetric").register("buyback-util",function(h,p,g,d){function n(a){var c=a%10;10<=a&&(c+=n(Math.floor(a/10)));return c}var c=h.$;g.init();var k=g.get();return{hide:function(){for(var a=0;a<arguments.length;a++)c("#"+arguments[a]).removeClass("show").addClass("hide")},
show:function(){for(var a=0;a<arguments.length;a++)c("#"+arguments[a]).removeClass("hide").addClass("show")},hideInline:function(){for(var a=0;a<arguments.length;a++)null!==c("#"+arguments[a])&&c("#"+arguments[a]).addClass("hide")},showInline:function(){for(var a=0;a<arguments.length;a++)null!==c("#"+arguments[a])&&c("#"+arguments[a]).removeClass("hide")},isValidBuyBackIMEI:function(){var a=c("#buyBackIMEITextInput").val(),f=0,b;if(15!==a.length||-1!==a.indexOf("."))return!1;a=Number(c("#buyBackIMEITextInput").val());
if(isNaN(a))return!1;for(var d=15;1<=d;d--)b=a%10,0===d%2&&(b*=2),f+=n(b),a=Math.floor(a/10);return 0===f%10?!0:!1},getFormattedPrice:function(a,c){"undefined"===typeof c&&(c=!1);a=a.toFixed(2);var b=Math.floor(a),d="";c?0<a.indexOf(".")&&b!=a&&(d=a.substring(a.indexOf("."),a.length)):0<a.indexOf(".")&&(d=a.substring(a.indexOf("."),a.length));b=b.toString();a=b.substring(b.length-3);b=b.substring(0,b.length-3);""!==b&&(a=","+a);return b.replace(/\B(?=(\d{2})+(?!\d))/g,",")+a+d},applyBuyBackOffer:function(a){var f=
!1,b={type:"post",url:"/gp/product/features/buyback/buyBackDiscountHandler.html?"+c.param({asin:a.asin,category:a.buyBackCategory,currencyCode:a.currencyCode,postalCode:a.postalCode,sellerId:a.sellerId,categoryIdentifier:a.categoryIdentifier,productPrice:a.buyBoxOfferBuyingPrice,buyBackOfferId:a.selectedBuyBackOfferData.offerId,isGepEligible:a.selectedBuyBackOfferData.gepEligibleBrandModel?1:0,discountValue:a.selectedBuyBackOfferData.discountPrice||(a.selectedBuyBackOfferData.gepEligibleBrandModel?
1:0),feeAsin:a.feeAsin,convenienceFee:a.convenienceFee}),async:!1,success:function(b){var c;try{c=JSON.parse(b)}catch(d){f=!1}"undefined"!==typeof c&&"SUCCESS"===c.status&&(f=!0,a.totalSponsoredValue=c.sponsoredDiscount,a.purchaseHistoryDiscount=c.purchaseHistoryDiscount,h.state("AdditionalSweetener",{sweetener:c.valueMatchingSweetener}))},error:function(){f=!1}};c.ajax(b);h.trigger("BUYBACK_DISCOUNT_HANDLER_FOR_DFL",f);return f},updateBestBuyBackOfferForCategory:function(a){var f=!1,b={type:"post",
url:"/gp/product/features/buyback/buyBackOffersForCategory.html?"+c.param({encryptedMarketPlaceId:a.encryptedMarketPlaceId,asin:a.asin,productPrice:a.productPrice,brand:a.brand,subCategoryName:a.subCategoryName,encryptedMerchantId:a.sellerId,postalCode:a.postalCode,buyBackCategory:a.categoryChosen,rbnHierarchyNodes:a.productCategory}),async:!1,success:function(b){var c;try{c=JSON.parse(b)}catch(d){f=!1}"undefined"!==typeof c&&"SERVICE-SUCCESS"===c.status&&(f=!0,a.buyBackExchangeItems="",""!==c.BestBuyBackOffer&&
null!==c.BestBuyBackOffer&&(b=JSON.parse(c.BestBuyBackOffer),a.buyBackExchangeItems=b.containedBuyBackProductNodes),a.buyBackCategory=c.BuyBackCategory,a.buyBackprompt1Text=c.Option1PromptText,a.buyBackprompt2Text=c.Option2PromptText,a.buyBackprompt3Text=c.Option3PromptText)},error:function(){f=!1}};c.ajax(b);return f},validateBrandAndModelBasedOnIMEI:function(a){var f={asin:a.asin,imeiNumber:a.imeiNumber,brand:a.selectedBuyBackOptions[0],model:a.selectedBuyBackOptions[1],category:a.buyBackCategory.toLowerCase(),
sellerId:a.sellerId,isGepEligible:a.selectedBuyBackOfferData.gepEligibleBrandModel?1:0,totalBuyBackDiscount:a.selectedBuyBackOfferData.discountPrice+a.totalSponsoredValue,productPrice:a.productPrice},b="FAILED",f={type:"post",url:"/gp/product/features/buyback/verifyIMEIHandler.html?"+c.param(f),async:!1,success:function(c){var f;try{f=JSON.parse(c)}catch(d){b="FAILED"}"undefined"!==typeof f&&"SUCCESS"===f.status?(b="SUCCESS",a.gepDiscountValue=f.gepDiscountValue,a.discountAppliedText=f.discountAppliedText,
a.gepSuccessNoteText=f.gepSuccessNoteText,a.gepFailureNoteText=f.gepFailureNoteText,a.gepStatusCode=f.gepStatusCode):"undefined"!==typeof f&&"MISMATCH"===f.status?b="MISMATCH":"undefined"!==typeof f&&"BLOCK"===f.status&&(b="BLOCK")},error:function(){b="FAILED"}};c.ajax(f);h.trigger("VALIDATE_IMEI_FOR_DFL",b,a);return b},setSelectedBuyBackOffer:function(a){var f=!0;c.each(a.buyBackExchangeItems,function(b,d){if(("C"===a.furnitureWeblabTreatment||1<a.noOfQuestions)&&d.header===a.selectedBuyBackOptions[0])c.each(d.containedBuyBackProductNodes,
function(b,d){if(d.header===a.selectedBuyBackOptions[1]){if(""===a.selectedBuyBackOptions[2]&&null!==d.buyBackProductDetails)return a.selectedBuyBackOfferData=d.buyBackProductDetails.buyBackOfferDetailsList[0],f=!1;c.each(d.containedBuyBackProductNodes,function(b,c){if(c.header===a.selectedBuyBackOptions[2]&&null!==c.buyBackProductDetails)return a.selectedBuyBackOfferData=c.buyBackProductDetails.buyBackOfferDetailsList[0],f=!1})}});else if(1===a.noOfQuestions&&d.header===a.selectedBuyBackOptions[0]){if(null!==
d.buyBackProductDetails)return a.selectedBuyBackOfferData=d.buyBackProductDetails.buyBackOfferDetailsList[0],f=!1;c.each(d.containedBuyBackProductNodes,function(b,c){if(c.header===a.selectedBuyBackOptions[2]&&null!==c.buyBackProductDetails)return a.selectedBuyBackOfferData=c.buyBackProductDetails.buyBackOfferDetailsList[0],f=!1})}return f});return f},auiNewPageStateParseLogicBuyBack:function(){var a=h.parseJSON,f=["buyBackPageState"];h.each(c('script[type\x3d"a-state"]'),function(b){b=c(b);if(!b.data("a-eval")){var d=
b.attr("data-a-state");if(d&&(d=a(d),d.key&&-1!==c.inArray(d.key,f))){var g=a(b.html());h.state.replace(d.key,g);b.data("a-eval",!0)}}})},getSponsoredDiscount:function(a,d,b,g){var u=0;a={type:"post",url:"/gp/product/features/buyback/buyBackAjaxHandler.html?"+c.param({asin:a.asin,category:a.buyBackCategory,currencyCode:a.currencyCode,postalCode:a.buyBackPostalCode,sellerId:a.sellerId,categoryIdentifier:a.categoryIdentifier,productPrice:a.buyBoxOfferBuyingPrice,buyBackOfferId:d,discountValue:b,imeiNumber:g,
brand:a.deviceBrandName,modelId:a.deviceModelId,feeAsin:a.feeAsin,convenienceFee:a.convenienceFee}),async:!1,success:function(a){var b;try{b=JSON.parse(a)}catch(c){u=0}"undefined"!==typeof b&&"SUCCESS"===b.status&&(u=b.sponsoredDiscount)},error:function(){u=0}};c.ajax(a);return u},getMaxDiagnosticsDiscount:function(a,d){a="/gp/product/features/buyback/buyBackDiagnosticOffer.html?"+c.param({sessionId:a.dpSessionId,asin:a.asin,diagnosticRunId:d,productPrice:a.buyBoxOfferBuyingPrice});var b=0;if(!d||
0===d.length)return b;c.ajax({type:"post",url:a,async:!1,success:function(a){var c;try{c=JSON.parse(a)}catch(d){b=0}"undefined"!==typeof c&&"SERVICE-SUCCESS"===c.status&&(b=c)},error:function(){b=0}});return b},getModelNameFromModelId:function(a,d){var b="";a={type:"post",url:"/gp/product/features/buyback/diagnosticMobileModelName.html?"+c.param({mobileModelId:d+"_"+a}),async:!1,success:function(a){var c;try{c=JSON.parse(a)}catch(d){b=""}"undefined"!==typeof c&&"SERVICE-SUCCESS"===c.status&&(b=c)},
error:function(){b=""}};c.ajax(a);return b},updateCustomerdata:function(a,d,b,g){var k=!1;a={type:"post",url:"/gp/product/features/buyback/updateBuyBackCustomerDataBySession.html?"+c.param({sessionId:a.dpSessionId,asin:a.asin,buyBackData:d,sponsoredOffers:b,diagnosticOffer:g}),async:!1,success:function(a){var c;try{c=JSON.parse(a)}catch(b){k=!1}"undefined"!==typeof c&&"SERVICE-SUCCESS"===c.status&&(k=!0)},error:function(){k=!1}};c.ajax(a);return k},fetchDeviceCheckRejectWeblabTreatment:function(){var a=
"C";c.ajax({type:"get",url:"/gp/product/features/buyback/buyBackDeviceCheckWeblabTrigger.html",async:!1,success:function(c){var b;try{b=JSON.parse(c)}catch(g){d.increment("BuyBack:buyBackDeviceCheckWeblabTrigger:jsonParse:count")}"undefined"!==typeof b&&"SUCCESS"===b.status&&(a=b.deviceCheckRejectWeblab,d.increment("BuyBack:deviceCheckRejectWeblab:success:count"))},error:function(){d.increment("BuyBack:deviceCheckRejectWeblab:error:count")}});return a},checkBuyBackAccordionRequest:function(c){return"undefined"===
typeof c||"BB"===c?!0:!1},checkValidDeviceCheckRequest:function(c,d,b){return"DFL"===c||this.checkBuyBackAccordionRequest(c)&&("C"===d||b)?!0:!1},checkDeviceCheckScreenAvailability:function(c,d){return"T1"!==c||"mobile"!==d&&"Mobile"!==d?!1:!0},setBuyBackDeviceCheckScreenImages:function(){var a=["https://m.media-amazon.com/images/G/31/buyback/device_check_screen/1.jpg","https://m.media-amazon.com/images/G/31/buyback/device_check_screen/2.jpg","https://m.media-amazon.com/images/G/31/buyback/device_check_screen/3.jpg",
"https://m.media-amazon.com/images/G/31/buyback/device_check_screen/4.jpg"];if(null!==c(".device-check-image-container"))for(var d=c(".device-check-image-container").length,b=a.length,g=0;g<d;g++){var k=a[g%b],r=c(".device-check-image-container")[g].childNodes[1];null!==r&&null!==r.childNodes[1]&&r.childNodes[1].setAttribute("src",k)}},setBuyBackExchangeTip:function(a,d,b){if(this.checkValidDeviceCheckRequest(a,d,b)){a=localStorage.getItem("deviceCheckRejectWeblabTreatment");d=c("#buybackMobileExchangeTipT1Treatment");
b=c("#buybackMobileExchangeTipT2Treatment");var g=c("#buybackMobileExchangeTip");d&&b&&g&&("T1"===k.deviceCheckWeblabAllocation&&"T1"===a?(this.hide("buybackMobileExchangeTipT1Treatment","buybackMobileExchangeTipT2Treatment","buybackMobileExchangeTip"),this.show("buybackMobileExchangeTipT1Treatment"),this.setBuyBackDeviceCheckScreenImages()):"T1"===k.deviceCheckWeblabAllocation&&"T2"===a?(this.hide("buybackMobileExchangeTipT1Treatment","buybackMobileExchangeTipT2Treatment","buybackMobileExchangeTip"),
this.show("buybackMobileExchangeTipT2Treatment"),this.setBuyBackDeviceCheckScreenImages()):"T1"===k.deviceCheckWeblabAllocation&&(this.hide("buybackMobileExchangeTipT1Treatment","buybackMobileExchangeTipT2Treatment","buybackMobileExchangeTip"),this.show("buybackMobileExchangeTip")))}}}});"use strict";q.when("A","a-button","a-dropdown","buyback-util","BBPageState","bbMetric","gep-util","buyBackPageStateStatic").execute(function(h,p,g,d,n,c,k){function a(c){var b={inlineContent:e.selectOldProductDetailsToolTipText,
position:"triggerBottom"};q.when("A","jQuery").execute(function(a,d){a.declarative.create(d("#"+c),"a-tooltip",b)})}function f(c){q.when("A","jQuery").execute(function(b,a){b.declarative.remove(a("#"+c),"a-tooltip")})}function b(c){""!==c&&null!==g.getSelect(l('[id\x3d"'+c+'"]'))&&g.getSelect(l('[id\x3d"'+c+'"]')).setValue("")}function v(){var b=n.callBBPageState?n.getUpdatedState():h.state("buyBackPageState");l.isEmptyObject(b)||(e.selectOldProductDetailsToolTipText=b.selectOldProductDetailsToolTipText,
e.productCategory=b.buyBackCategory,e.buyBackCategory=b.buyBackCategory,e.enableRefactoring=b.enableRefactoring,e.buyBackprompt1Text=b.buyBackDropDown1prompt,e.buyBackprompt2Text=b.buyBackDropDown2prompt,e.buyBackprompt3Text=b.buyBackDropDown3prompt,e.categoryIdentifier=b.categoryIdentifier,e.buyBackExchangeItems=b.buyBackExchangeItems,e.currencyCode=b.currencyCode,e.buyBackMobile=b.buyBackMobile,e.buyBoxOfferBuyingPrice=Number(b.buyBoxOfferBuyingPrice),e.convenienceFee="",b.convenienceFee!==m?e.convenienceFee=
Number(b.convenienceFee):(c.increment("BuyBack:web:noConvenienceFeeConfigured:count"),e.convenienceFee=0),e.feeAsin="",b.feeAsin!==m&&(e.feeAsin=b.feeAsin),e.asin=b.asin,e.sellerId=b.sellerId,e.brand=b.brand,e.subCategoryName=b.subCategoryName,e.postalCode=b.buyBackPostalCode,e.encryptedMarketPlaceId=b.marketPlaceId,e.productPrice=b.productPrice,e.crossCategoryOfferAvailable=b.crossCategoryOfferAvailable,e.convenienceFeeWeblabAllocation=b.convenienceFeeWeblabAllocation,e.dpFeeStringTextEnabled=b.dpFeeStringTextEnabled,
e.feeMap=b.feeMap,e.noOfQuestions=b.noOfQuestions,e.furnitureWeblabTreatment=b.furnitureWeblabTreatment,e.audioWeblabTreatment=b.audioWeblabTreatment,e.gepEligible=b.gepEligibleCustomer)}function u(){p("#buyBackBuyNowButton").enable();f("buyBackBuyNowToolTip")}function r(){p("#buyBackBuyNowButton").disable();a("buyBackBuyNowToolTip")}function z(){var b=e.buyBoxOfferBuyingPrice-(e.selectedBuyBackOfferData.discountPrice+e.totalSponsoredValue+e.purchaseHistoryDiscount);if("T1"===e.convenienceFeeWeblabAllocation)if(""===
e.convenienceFee)B();else{var c=Number(e.convenienceFee),b=b+c;l("#isBuyBackFee")[0]===m?A():t();!0===e.dpFeeStringTextEnabled&&l("#convenienceFeeCharge").text(c)}b=d.getFormattedPrice(b);l("#priceAfterBuyBackDiscount").text(b)}function A(){l("#buyBackBuyNow").append('\x3cinput type\x3d"hidden" id\x3d"isBuyBackKey" name\x3d"custom-name.2.1" value\x3d"UNIQ-buyBack"\x3e\x3cinput type\x3d"hidden" id\x3d"isBuyBackFee" name\x3d"custom-value.2.1" value\x3d"BuyBackFee"\x3e')}function t(){l("#isBuyBackKey").val("UNIQ-buyBack");
l("#isBuyBackFee").val("BuyBackFee")}function B(){l("#feeAsin")[0]!==m&&l("#feeAsin")[0].value!==m&&l("#feeAsin").val("");l("#feeOfferingId")[0]!==m&&l("#feeOfferingId")[0].value!==m&&l("#feeOfferingId").val("");l("#isBuyBackKey")[0]!==m&&l("#isBuyBackKey")[0].value!==m&&l("#isBuyBackKey").val("");l("#isBuyBackFee")[0]!==m&&l("#isBuyBackFee")[0].value!==m&&l("#isBuyBackFee").val("")}function w(a){c.increment("BuyBack:web:discountApply:count");r();var f=e.selectedBuyBackOfferData.gepEligibleBrandModel;
c.startTimer("BuyBack:web:ajaxSave");var g=d.applyBuyBackOffer(e);c.stopTimer("BuyBack:web:ajaxSave");if(g){a=e.selectedBuyBackOfferData.discountPrice+e.totalSponsoredValue+e.purchaseHistoryDiscount;var g=h.state("AdditionalSweetener"),v=0;l.isEmptyObject(g)||(v=g.sweetener);g=e.totalSponsoredValue-v;l("#buyBackDiscountPrice").text(d.getFormattedPrice(a));l("#buyBackSponsoredDiscount").text(d.getFormattedPrice(g));0<g?d.show("buyBackSponsoredDiscountText"):d.hide("buyBackSponsoredDiscountText");!0===
e.dpFeeStringTextEnabled&&""!==e.convenienceFee&&d.show("buyBackConvenienceFeeTextSection");d.show("buyBackOfferAppliedSuccess","buyBackOfferAppliedSuccessText","priceAfterBuyBackDiscountSection","buyBackDetailsVerifyText","buyBackTermsAndConditions");d.hide("buyBackCollectOldProductDetailsText","maxBuyBackDiscountSection","buyBackServiceFailedAlert");z();e.buyBackCategory.toLowerCase()!==e.buyBackMobile.toLowerCase()?u():(f?(d.show("buyBackIMEISection"),k.showGEPInfoDiv(e)):d.show("buyBackIMEISection",
"buyBackVerifyIMEIText"),d.hide("buyBackTermsAndConditions","buyBackIMEIUpdate"));c.increment("BuyBack:web:dataSaveSuccess:count")}else f?k.showGEPDivsWhenRegularExchangeNotPresent():(c.increment("BuyBack:web:dataSaveFailed:count"),d.show("buyBackServiceFailedAlert","buyBackCollectOldProductDetailsText","maxBuyBackDiscountSection"),d.hide("buyBackDetailsVerifyText","buyBackOfferAppliedSuccess","buyBackTermsAndConditions","priceAfterBuyBackDiscountSection","buyBackIMEISection","buyBackConvenienceFeeTextSection"),
b(a))}function C(){h.on("a:dropdown:select",function(a){"buyBackDropDown0"===a.name?y():"buyBackDropDown1"===a.name?(c.increment("BuyBack:web:dropDown1Select:count"),d.hide("buyBackSelectDropDown2Alert","buyBackDropDown2","buyBackOfferAppliedSuccess","buyBackIMEISection","buyBackExchangeMightBeEligibleText","buyBackDetailsVerifyText","buyBackTermsAndConditions","priceAfterBuyBackDiscountSection","buyBackServiceFailedAlert","buyBackIMEIMismatchAlert","buybackImeiBlockAlert","buyBackConvenienceFeeTextSection"),
l(".buyBackGEPCustomer").removeClass("show").addClass("hide"),e.selectedBuyBackOptions[0]=l("#buyBackDropDown1").val(),d.show("buyBackDropDowns2"),l('[id\x3d"'+e.previousSelectedBuyBackOptions[0]+'Id"]').removeClass("show").addClass("hide"),l('[id\x3d"'+e.selectedBuyBackOptions[0]+'Id"]').removeClass("hide").addClass("show"),"tv"===e.buyBackCategory.toLowerCase()&&d.show("buyBackItemWorkingConditionText"),d.show("buyBackCollectOldProductDetailsText","maxBuyBackDiscountSection"),e.categoryChosen.toLowerCase()===
e.buyBackMobile?d.hide("buyBackDropDown3"):d.show("buyBackDropDown3"),b(e.previousSelectedBuyBackOptions[0]),""!==e.previousSelectedBuyBackOptions[1]&&(a=e.previousSelectedBuyBackOptions[0]+e.previousSelectedBuyBackOptions[1],l('[id\x3d"'+a+'Id"]').removeClass("show").addClass("hide"),b(a)),e.previousSelectedBuyBackOptions[0]=e.selectedBuyBackOptions[0],"T1"!==e.furnitureWeblabTreatment||1!==e.noOfQuestions||d.setSelectedBuyBackOffer(e)?r():w(e.selectedBuyBackOptions[0])):a.name===l("#buyBackDropDown1").val()?
(c.increment("BuyBack:web:dropDown2Select:count"),e.selectedBuyBackOptions[1]=l('[id\x3d"'+e.selectedBuyBackOptions[0]+'"]').val(),d.hide("buyBackExchangeMightBeEligibleText"),l(".buyBackGEPCustomer").removeClass("show").addClass("hide"),"T1"!==e.audioWeblabTreatment||2!==e.noOfQuestions||d.setSelectedBuyBackOffer(e)?(r(),e.buyBackCategory.toLowerCase()===e.buyBackMobile.toLowerCase()?(d.hide("buyBackDropDown3","buyBackIMEIMismatchAlert","buyBackValidIMEIAlert","buyBackIMEIUpdateText","buyBackCollectOldProductDetailsText",
"buybackImeiBlockAlert"),d.show("buyBackHowToGetIMEI","buyBackIMEISection","buyBackDetailsVerifyText"),l("#buyBackIMEITextInput").removeClass("a-form-error"),l("#buyBackIMEITextInput").val(""),d.setSelectedBuyBackOffer(e)||w(e.selectedBuyBackOptions[0])):(d.hide("buyBackOfferAppliedSuccess","buyBackDetailsVerifyText","buyBackTermsAndConditions","priceAfterBuyBackDiscountSection","buyBackServiceFailedAlert","buyBackValidIMEIAlert","buyBackIMEIMismatchAlert","buyBackIMEIUpdateText","buyBackDropDown3",
"buybackImeiBlockAlert","buyBackConvenienceFeeTextSection"),d.show("buyBackCollectOldProductDetailsText","maxBuyBackDiscountSection","buyBackDropDowns3"),""!==e.previousSelectedBuyBackOptions[1]&&(a=e.previousSelectedBuyBackOptions[0]+e.previousSelectedBuyBackOptions[1],l('[id\x3d"'+a+'Id"]').removeClass("show").addClass("hide"),b(a)),l('[id\x3d"'+e.selectedBuyBackOptions[0]+e.selectedBuyBackOptions[1]+'Id"]').removeClass("hide").addClass("show"),e.previousSelectedBuyBackOptions[1]=e.selectedBuyBackOptions[1])):
w(e.selectedBuyBackOptions[0])):a.name===e.selectedBuyBackOptions[0]+e.selectedBuyBackOptions[1]&&(c.increment("BuyBack:web:dropDown3Select:count"),d.hide("buyBackExchangeMightBeEligibleText"),l(".buyBackGEPCustomer").removeClass("show").addClass("hide"),e.selectedBuyBackOptions[2]=l('[id\x3d"'+e.selectedBuyBackOptions[0]+e.selectedBuyBackOptions[1]+'"]').val(),d.setSelectedBuyBackOffer(e)||w(e.selectedBuyBackOptions[0]+e.selectedBuyBackOptions[1]))});l("#buyBackIMEITextInput").bind("change input",
function(){c.increment("BuyBack:web:imeiInput:count");d.hide("buyBackValidIMEIAlert","buyBackIMEIUpdate","buyBackServiceFailedAlert","buyBackTermsAndConditions","buyBackIMEIMismatchAlert","buybackImeiBlockAlert","buyBackGEPIMEISuccessAlert","buyBackGEPSuccessNotes");d.show("buyBackHowToGetIMEI","buyBackVerifyIMEIText","buyBackOfferAppliedSuccess");l("#buyBackIMEITextInput").removeClass("a-form-error");k.showGEPInfoDiv(e);r()});l("#buyBackApplyButton").unbind("click").click(function(){c.increment("BuyBack:web:apply:count");
e.imeiNumber=l("#buyBackIMEITextInput").val();if(d.isValidBuyBackIMEI()){e.gepEligible=k.gepEligibleCustomer?1:0;var b=d.validateBrandAndModelBasedOnIMEI(e);if("FAILED"===b)c.increment("BuyBack:web:imeiServiceFailed:count"),r(),d.show("buyBackServiceFailedAlert","buyBackVerifyIMEIText"),d.hide("buyBackTermsAndConditions","buyBackIMEIMismatchAlert","buyBackValidIMEIAlert","buyBackIMEIUpdate","buybackImeiBlockAlert","buyBackGEPIMEISuccessAlert","buyBackGEPSuccessNotes"),k.showGEPInfoDiv(e);else if("MISMATCH"===
b)c.increment("BuyBack:web:imeiMismatch:count"),r(),l("#buyBackIMEITextInput").addClass("a-form-error"),d.show("buyBackIMEIMismatchAlert","buyBackVerifyIMEIText"),d.hide("buyBackTermsAndConditions","buyBackServiceFailedAlert","buyBackValidIMEIAlert","buyBackIMEIUpdate","buybackImeiBlockAlert","buyBackGEPIMEISuccessAlert","buyBackGEPSuccessNotes"),k.showGEPInfoDiv(e);else if("BLOCK"===b)c.increment("BuyBack:web:imeiBlock:count"),r(),l("#buyBackIMEITextInput").addClass("a-form-error"),d.show("buybackImeiBlockAlert",
"buyBackVerifyIMEIText"),d.hide("buyBackTermsAndConditions","buyBackServiceFailedAlert","buyBackValidIMEIAlert","buyBackIMEIUpdate","buyBackIMEIMismatchAlert","buyBackGEPIMEISuccessAlert","buyBackGEPSuccessNotes"),k.showGEPInfoDiv(e);else if("SUCCESS"===b)if(c.increment("BuyBack:web:correctIMEI:count"),d.hide("buyBackHowToGetIMEI","buyBackVerifyIMEIText","buyBackGEPIMEIInfoAlert","buyBackIMEIMismatchAlert","buyBackValidIMEIAlert","buyBackServiceFailedAlert","buybackImeiBlockAlert"),u(),e.selectedBuyBackOfferData.gepEligibleBrandModel)if(k.showGEPDivPostIMEIValidation(e),
e.gepDiscountValue){b=e.buyBoxOfferBuyingPrice-e.gepDiscountValue;if("T1"===e.convenienceFeeWeblabAllocation)if(""===e.convenienceFee)B();else{var a=Number(e.convenienceFee),b=b+a;l("#isBuyBackFee")[0]===m?A():t();!0===e.dpFeeStringTextEnabled&&l("#convenienceFeeCharge").text(a)}b=d.getFormattedPrice(b);l("#priceAfterBuyBackDiscount").text(b);d.hide("maxBuyBackDiscountSection");d.show("priceAfterBuyBackDiscountSection")}else z();else 11===e.gepStatusCode?(c.increment("BuyBack:GEP:gepNotEligibleDueToCustomerNotLoggedIn:count"),
l("#buyBackGEPNotEligibleAlert").html(e.gepFailureNoteText),d.hide("buyBackGEPIMEISuccessAlert"),d.show("buyBackGEPNotEligibleAlert","buyBackOfferAppliedSuccess","buyBackTermsAndConditions")):(d.hide("buyBackGEPNotEligibleAlert","buyBackOfferAppliedSuccess"),d.show("buyBackIMEIUpdate","buyBackTermsAndConditions"))}else l("#buyBackIMEITextInput").addClass("a-form-error"),d.hide("buyBackGEPNotEligibleAlert","buyBackOfferAppliedSuccess","buyBackIMEIUpdate","buyBackTermsAndConditions","buyBackServiceFailedAlert",
"buyBackGEPIMEISuccessAlert","buyBackGEPSuccessNotes"),d.show("buyBackValidIMEIAlert","buyBackHowToGetIMEI","buyBackVerifyIMEIText"),k.showGEPInfoDiv(e),r()})}function D(b,c,a,d,e){if("undefined"===typeof c)return"";var f="\x3cspan class\x3d'a-dropdown-container'\x3e\x3cselect name\x3d'"+d+a+"' id\x3d'"+d+a+"' tabindex\x3d'-1' class\x3d'a-native-dropdown a-button-span12 a-spacing-none'\x3e\x3coption class\x3d'a-prompt' value\x3d''\x3e"+e+"\x3c/option\x3e";l.each(c,function(b,c){f=f+"\x3coption value\x3d'"+
c.header+"'\x3e"+c.header+"\x3c/option\x3e"});return f=f+"\x3c/select\x3e\x3cspan tabindex\x3d'-1' id\x3d'"+d+a+"Id' class\x3d'a-button a-button-dropdown a-spacing-none a-button-span12 hide' \x3e\x3cspan class\x3d'a-button-inner'\x3e\x3cspan class\x3d'a-button-text a-declarative' data-action\x3d'a-dropdown-button' role\x3d'button' tabindex\x3d'0'\x3e\x3cspan class\x3d'a-dropdown-prompt'\x3e"+e+"\x3c/span\x3e\x3c/span\x3e\x3ci class\x3d'a-icon a-icon-dropdown'\x3e\x3c/i\x3e\x3c/span\x3e\x3c/span\x3e\x3c/span\x3e"}
function x(){if("undefined"!==typeof e.buyBackExchangeItems){var b="",c="";l.each(e.buyBackExchangeItems,function(a,d){b+=D(a,d.containedBuyBackProductNodes,d.header,"",e.buyBackprompt2Text);var f=d.header;l.each(d.containedBuyBackProductNodes,function(b,a){c+=D(b,a.containedBuyBackProductNodes,a.header,f,e.buyBackprompt3Text)})});l("#buyBackDropDowns2").html(b);l("#buyBackDropDowns3").html(c)}}function E(){if("undefined"!==typeof e.buyBackExchangeItems&&""!==e.buyBackExchangeItems){g.getSelect("buyBackDropDown1").getOptions().remove();
g.getSelect("buyBackDropDown1").addOptions(F(e.buyBackExchangeItems));var b=e.buyBackprompt1Text;g.getSelect("buyBackDropDown1").update({option_prompt:b});q.when("A").execute(function(b){b.$("#buyBackDropDown1Id").show()});d.show("buyBackDropDown1Id","buyBackDropDowns1");("C"===e.furnitureWeblabTreatment||1<e.noOfQuestions)&&x()}}function F(b){var c=[];h.each(b,function(b){c.push({text:b.header,value:b.header})});return c}function y(){h.on("a:dropdown:select",function(b){if("buyBackDropDown0"===b.name){c.increment("BuyBack:web:dropDown0Select:count");
c.startTimer("BuyBack:web:getBuyBackCrossCategoryOffers");d.hide("buyBackSelectDropDown2Alert","buyBackDropDown2","buyBackOfferAppliedSuccess","buyBackIMEISection","buyBackDetailsVerifyText","buyBackTermsAndConditions","priceAfterBuyBackDiscountSection","buyBackServiceFailedAlert","buyBackIMEIMismatchAlert","buyBackDropDown3","buyBackValidIMEIAlert","buyBackIMEIUpdate","buyBackMobileWorkingConditionText","mobileExchangeNotAvailableAtPincode","buyBackItemWorkingConditionText","buybackImeiBlockAlert",
"buyBackConvenienceFeeTextSection");d.show("buyBackCollectOldProductDetailsText","maxBuyBackDiscountSection");e.categoryChosen=l("#buyBackDropDown0").val();if("T1"===e.convenienceFeeWeblabAllocation){var a=e.productCategory.toLowerCase()+"_"+e.categoryChosen.toLowerCase();e.convenienceFee="";e.feeAsin="";e.feeMap===m?(b="BuyBack:web:noEntryExistsFor"+e.productCategory.toLowerCase()+":count",c.increment(b)):e.feeMap.map[a]===m?c.increment("BuyBack:web:noEntryExistsFor"+a+":count"):!0===e.feeMap.map[a].feeEnabled?
(b=e.feeMap.map[a].asin,e.convenienceFee=e.feeMap.map[a].price,e.feeAsin=b,a=e.feeMap.map[a].offeringId,l("#feeAsin").val(b),l("#feeOfferingId").val(a)):c.increment("BuyBack:web:feeDisabledFor"+a+":count")}e.selectedBuyBackOptions=["","",""];e.previousSelectedBuyBackOptions=["",""];b=d.updateBestBuyBackOfferForCategory(e);""===e.buyBackExchangeItems||!1===b?(c.increment("BuyBack:web:crossCategoryOfferNotAvailableStringShown:count"),c.startTimer("BuyBack:web:crossCategoryOfferNotAvailable"),e.buyBackExchangeItems=
"",d.hide("buyBackDropDowns1","buyBackDropDowns2","buyBackDropDowns3","buyBackSelectDropDown2Alert","buyBackDropDown2","buyBackOfferAppliedSuccess","buyBackIMEISection","buyBackDetailsVerifyText","buyBackTermsAndConditions","priceAfterBuyBackDiscountSection","buyBackServiceFailedAlert","buyBackIMEIMismatchAlert","buyBackDropDown1Id","buyBackCollectOldProductDetailsText","buybackImeiBlockAlert","buyBackConvenienceFeeTextSection"),d.hide("buyBackCollectOldProductDetailsText"),d.show("mobileExchangeNotAvailableAtPincode"),
r(),c.stopTimer("BuyBack:web:crossCategoryOfferNotAvailable")):(e.categoryChosen.toLowerCase()===e.buyBackMobile&&(d.hide("buyBackDropDown3"),d.show("buyBackMobileWorkingConditionText")),"tv"===e.categoryChosen.toLowerCase()&&d.show("buyBackItemWorkingConditionText"),g.getSelect("buyBackDropDown1").update({option_prompt:e.buyBackprompt1Text}),c.stopTimer("BuyBack:web:getBuyBackCrossCategoryOffers"));""!==e.buyBackExchangeItems&&E()}})}var l=h.$,e={selectedBuyBackOptions:["","",""],previousSelectedBuyBackOptions:["",
""],imeiNumber:"",totalSponsoredValue:0,purchaseHistoryDiscount:0,enableRefactoring:!1,categoryChosen:"",productCategoryToDbMapping:{tv:"TV",refrigerator:"Refrigerator",laptop:"Laptop",washingmachine:"WashingMachine",tablet:"Tablet",ac:"AC"},bulkyCategories:"tv washingmachine refrigerator ac sofa coffeetable mattress wardrobe recliner shoerack tvunit studytable officechair bed".split(" ")};h.on("a:accordion:buybox-accordion:buyBackAccordionRow:select",function(b){c.increment("BuyBack:web:buyBackAccordionRow:select:count");
l=h.$;b=document.getElementById("buyBackDropDown0");var a=e.crossCategoryOfferAvailable;v();var f=l("#isSlotsAvailable").attr("value");-1<e.bulkyCategories.indexOf(e.buyBackCategory.toLowerCase())&&f!==m&&"false"===f?(c.increment("BuyBack:web:hnbFaddBuyBackSuppression:count"),c.startTimer("BuyBack:web:hnbFaddBuyBackSuppression"),l("#buyBackDropDowns3").parent().addClass("aok-hidden"),l("#buyBackDropDown0").parent().parent().addClass("aok-hidden"),d.hide("maxBuyBackDiscountSection","buyBackDropDowns1",
"buyBackDropDowns2","buyBackDropDowns3","buyBackSelectDropDown2Alert","buyBackDropDown2","buyBackOfferAppliedSuccess","buyBackIMEISection","buyBackDetailsVerifyText","buyBackTermsAndConditions","priceAfterBuyBackDiscountSection","buyBackServiceFailedAlert","buyBackIMEIMismatchAlert","buyBackDropDown1Id","buyBackCollectOldProductDetailsText","buybackImeiBlockAlert","buyBackConvenienceFeeTextSection"),d.show("mobileExchangeNotAvailableAtPincode"),p("#buyBackBuyNowButton").disable(),c.stopTimer("BuyBack:web:hnbFaddBuyBackSuppression")):
a!==m&&null!==b&&"false"===e.crossCategoryOfferAvailable&&(c.increment("BuyBack:web:mobileOffersNotAvailable:count"),e.productCategory.toLowerCase()!==e.categoryChosen.toLowerCase()&&(e.buybackCategory=e.productCategory,e.categoryChosen=e.productCategoryToDbMapping[e.productCategory],d.updateBestBuyBackOfferForCategory(e),("C"===e.furnitureWeblabTreatment||1<e.noOfQuestions)&&x()),d.hide("buyBackDropDowns0SectionId","buyBackDropDown0Id","buyBackDropDown0","mobileExchangeNotAvailableAtPincode","buyBackIMEISection"),
d.show("buyBackDropDown1","buyBackDropDown1Id","buyBackDropDowns1"))});h.on("a2i_dpx:buyback:processBBPageState",function(){n.callBBPageState&&n.getUpdatedState();d.auiNewPageStateParseLogicBuyBack();v();y();("C"===e.furnitureWeblabTreatment||1<e.noOfQuestions)&&e.enableRefactoring&&x();C()});(function(){var a=l("#buyBackDropDown0").val();"undefined"!==typeof a&&""!==a&&b("buyBackDropDown0");a=l("#buyBackDropDown1").val();if("undefined"!==typeof a&&""!==a){var c=l('[id\x3d"'+a+'"]').val();b("buyBackDropDown1");
"undefined"!==typeof c&&""!==c&&(b(a),b(a+c))}})();v();y();("C"===e.furnitureWeblabTreatment||1<e.noOfQuestions)&&e.enableRefactoring&&x();C()});"use strict";q.when("A","ready").register("bbMetric",function(h){var p=t.ue,g={};return{increment:function(d){"undefined"!==typeof p&&"undefined"!==typeof p.count&&d&&p.count(d,(p.count(d)||0)+1)},stopTimer:function(d){"function"===typeof t.uet&&g.hasOwnProperty(d)&&(delete g[d],t.uet("be",d,{wb:1}),t.uex("ld",d,{wb:1}))},startTimer:function(d){"function"!==
typeof t.uet||g.hasOwnProperty(d)||(g[d]=1,t.uet("bb",d,{wb:1}))}}});"use strict";q.when("A","a-button","buyback-util","bbMetric","BBPageState","DiagnosticsState","Logger","gep-util","buyBackPageStateStatic").register("DiagnosticsUtils",function(h,p,g,d,n,c,k,a){k.log("DiagnosticsUtils file");var f=h.$;return{buyBackState:n.get(),setupNonAutoDetectAccordionRowCallback:null,startDiagnosticsFlow:function(){k.log("startDiagnosticsFlow");"function"!==typeof submitDiagnosticsForm&&(document.getElementById("backUrl").value=
t.location.href,document.getElementById("diagnosticsForm").submit())},getAndroidVersion:function(){k.log("getAndroidVersion");var b=navigator.userAgent.match(/Android[\/]*[\d\.]+/),a="0.0";null!==b&&null!==b[0]&&(b=b[0].split("/"),null!==b&&(a=b[1]));return parseFloat(a,10)},getAmazonAppVersion:function(){k.log("getAmazonAppVersion");var b=navigator.userAgent.match(/Amazon.com[\/]*[\d\.]+/),a="0.0";null!==b&&null!==b[0]&&(b=b[0].split("/"),null!==b&&(a=b[1]));return parseFloat(a.split(".")[0]+"."+
a.split(".")[1],10)},checkPhoneRootedAPI:function(){k.log("checkPhoneRootedAPI");t.cordova.require("cordova/exec")(this.phoneRootedCallbackSuccess.bind(this),this.phoneRootedCallbackError.bind(this),"MShopMobileAutoDiagnostic","isPhoneRooted",{})},runAutoDetectionAPI:function(){k.log("runAutoDetectionAPI");t.cordova.require("cordova/exec")(this.autoDetectCallback.bind(this),this.autoDetectCallback.bind(this),"MShopMobileAutoDiagnostic","getAutoDetectPhoneInfo",{})},triggerAutoClick:function(){k.log("triggerAutoClick");
var b=document.getElementById("buyBackAccordionRow");null!==b&&b!==m&&b.classList.contains("a-accordion-active")&&!1===c._clickedAlready&&(c._clickedAlready=!0,this.primaryAccordionClick())},triggerAutoClickAfterDiagnostics:function(){k.log("triggerAutoClickAfterDiagnostics");if("BB"===this.buyBackState.programName){d.increment("BuyBack:mobile:autoDiagnosticRunSuccess:count");var b=f("#buyBackAccordionRow a.a-accordion-row");null!==b&&0<b.length&&f(b)[0].click()}},primaryAccordionClick:function(){k.log("primaryAccordionClick");
g.hide("autoDetectionAccordion");g.hide("withAutoDetection-accordion","withoutAutoDetection-accordion");p("#buyBackBuyNowButton").disable();g.hide("buyBackConfirmButton");if("BB"===this.buyBackState.programName){f("#autoDetectionAccordion").show();this.setHiddenRowInElement(f("#withoutAutoDetection-accordion .a-accordion-inner"));var b=f("#withAutoDetection-accordion a.a-accordion-row");g.show("withAutoDetection-accordion","withoutAutoDetection-accordion");null!==b&&0<b.length&&f(b)[0].click();f("#diagnosticsSpinnerDiv").hide();
g.show("autoDetectionAccordion")}else this.runAutoDetection()},runAutoDetection:function(){k.log("runAutoDetection");c._androidVersion=this.getAndroidVersion();c._amazonAppVersion=this.getAmazonAppVersion();5>c._androidVersion?d.increment("BuyBack:mobile:autoDetectionFailedOldAppAndroid:count"):12.7>c._amazonAppVersion?d.increment("BuyBack:mobile:autoDetectionFailedOldAppAmazon:count"):a.isGEPEligibleCustomer(this.buyBackState)?(d.increment("BuyBack:mobile:autoDetectionSkippedGEPCustomer:count"),
c._shouldRunAutoDetect=!1,this.showAutoDetectionResult()):(f("#diagnosticsSpinnerDiv").show(),g.hide("autoDetectionAccordion"),this.checkPhoneRootedAPI(),this.runAutoDetectionAPI())},addAutoDetectDataToState:function(){k.log("addAutoDetectDataToState");this.buyBackState.imeiNumber=c._imeiNumber;this.buyBackState.deviceBrandName=c._deviceBrandName;this.buyBackState.deviceModelName=c._deviceModelName;this.buyBackState.deviceModelId=c._deviceModelId;n._buyBackState=this.buyBackState},showAutoDetectionResult:function(){k.log("showAutoDetectionResult");
if(c._shouldRunAutoDetect&&(!1===c._ranPhoneRooted||!1===c._ranAutoDetection))return!1;f("#diagnosticsSpinnerDiv").hide();g.show("autoDetectionAccordion");if(!1===c._shouldRunAutoDetect||!1===c._isAutoDetectSuccessfull||!0===c._isPhoneRooted)f("#buybackAccordion").remove(),this.setHiddenRowInElement(f("#hidden-accordion-content")),f("#hidden-accordion-content").removeClass("aok-hidden");else{d.increment("BuyBack:mobile:autoDetectionShown:count");this.setHiddenRowInElement(f("#withoutAutoDetection-accordion .a-accordion-inner"));
var b=f("#withAutoDetection-accordion a.a-accordion-row");g.show("withAutoDetection-accordion","withoutAutoDetection-accordion");this.addAutoDetectDataToState();null!==b&&0<b.length&&f(b)[0].click()}},setHiddenRowInElement:function(b){k.log("setHiddenRowInElement");if(("C"===this.buyBackState.soppWeblabTreatment||this.buyBackState.dflEligible)&&null!==c._lastHiddenElem&&0===f("#hidden-accordion-content").html().length)return!1;k.log("setHiddenRowInElement:"+b.selector);f("#hidden-accordion-content").html("");
c._lastHiddenElem=b;b.html(c._hiddenRowHTML);g.setBuyBackExchangeTip("BB",this.buyBackState.soppWeblabTreatment,this.buyBackState.dflEligible);this.setupNonAutoDetectAccordionRowCallback()},autoDetectCallback:function(b){k.log("autoDetectCallback");var a=!1;if(null===b.model||b.model===m)d.increment("BuyBack:mobile:autoDetectionFailedAPI:count"),k.log("BuyBack:mobile:autoDetectionFailedAPI:count"),a=!0;if(!a){var f=g.getModelNameFromModelId(b.model,b.brand).MobileModelName;null===f||f===m||""===f?
(d.increment("BuyBack:mobile:autoDetectionFailedModel:count"),k.log("BuyBack:mobile:autoDetectionFailedModel:count"),a=!0):null===b.imeiNumber||b.imeiNumber===m||""===b.imeiNumber?(d.increment("BuyBack:mobile:autoDetectionFailedIMEI:count"),k.log("BuyBack:mobile:autoDetectionFailedIMEI:count"),a=!0):(c._imeiNumber=b.imeiNumber,c._deviceBrandName=b.brand,c._deviceModelName=f,c._deviceModelId=b.model)}a||(b=this.setAutoDetectDiscount(c._deviceBrandName,c._deviceModelName),null!==b&&b!==m&&0!==b.discount)||
(d.increment("BuyBack:mobile:autoDetectionFailedDiscount:count"),k.log("BuyBack:mobile:autoDetectionFailedDiscount:count"),a=!0);c._ranAutoDetection=!0;c._isAutoDetectSuccessfull=!a;this.showAutoDetectionResult()},phoneRootedCallbackSuccess:function(b){k.log("phoneRootedCallbackSuccess");"true"===b.rootedStatus?(d.increment("BuyBack:mobile:autoDetectionFailedRooted:count"),c._isPhoneRooted=!0):c._isPhoneRooted=!1;c._ranPhoneRooted=!0;this.showAutoDetectionResult()},phoneRootedCallbackError:function(b){k.log("phoneRootedCallbackError");
c._isPhoneRooted=!1;c._ranPhoneRooted=!0;d.increment("BuyBack:mobile:phoneRootedAPIFailed:count");this.showAutoDetectionResult()},bindDiagnosticsFunctionality:function(b,a,u){k.log("bindDiagnosticsFunctionality");this.buyBackState="T1"!==a&&"T2"!==a||u?n.get():n.getUpdatedState();this.setupNonAutoDetectAccordionRowCallback=b;var r=this;c._hiddenRowHTML=f("#hidden-accordion-content").html();f("#hidden-accordion-content").html("");k.log("Cleared hidden html");if("T1"!==a&&"T2"!==a||u)h.on("a:accordion:buybox-accordion:buyBackAccordionRow:select",
function(b){f("#diagnosticsSpinnerDiv").show();g.hide("autoDetectionAccordion");c._clickedAlready=!0;r.primaryAccordionClick()});else f("#diagnosticsSpinnerDiv").show(),g.hide("autoDetectionAccordion"),c._clickedAlready=!0,r.primaryAccordionClick();f("#autoDiagnosticsIngress").click(function(){d.increment("BuyBack:mobile:runDiagnostic:click:count");r.startDiagnosticsFlow()});h.on("a2i_dpx:buyback:processBBPageState",function(){k.log("diagnostics:a2i_dpx:buyback:processBBPageState");r.buyBackState=
n.getUpdatedState()});h.on("a:accordion:buybackAccordion:withAutoDetection-accordion:select",function(b){p("#buyBackBuyNowButton").disable();g.hide("buyBackConfirmButton");r.accordionClick()});this.triggerAutoClick();this.triggerAutoClickAfterDiagnostics()},setAutoDetectDiscount:function(b,a){k.log("setAutoDetectDiscount");var d={discount:0,offerId:""};if(null!==this.buyBackState.buyBackExchangeItems&&this.buyBackState.buyBackExchangeItems!==m){for(var f=0;f<this.buyBackState.buyBackExchangeItems.length;f++){var g=
this.buyBackState.buyBackExchangeItems[f];if(b.toUpperCase()===g.header.toUpperCase()){c._deviceBrandName=g.header;for(var g=g.containedBuyBackProductNodes,h=0;h<g.length;h++)if(a.toUpperCase()===g[h].header.toUpperCase())return d.discount=g[h].buyBackProductDetails.buyBackOfferDetailsList[0].discountPrice,d.offerId=g[h].buyBackProductDetails.buyBackOfferDetailsList[0].offerId,d}}return d}},accordionClick:function(){k.log("accordionClick");"BB"!==this.buyBackState.programName?this.showADRowBeforeDiagnostics():
(c._imeiNumber=this.buyBackState.imeiNumber,c._deviceBrandName=this.buyBackState.deviceBrandName,c._deviceModelName=this.buyBackState.deviceModelName,this.showADRowAfterDiagnostics())},showADRowBeforeDiagnostics:function(){k.log("showADRowBeforeDiagnostics");g.hide("autoDiagnosticsIngress");f("#brand").text(c._deviceBrandName).removeClass("hide").addClass("show");f("#deviceBrand").val(c._deviceBrandName);f("#model").text(c._deviceModelName).removeClass("hide").addClass("show");f("#deviceModel").val(c._deviceModelName);
f("#imei").val(c._imeiNumber);var b=this.setAutoDetectDiscount(c._deviceBrandName,c._deviceModelName),a=g.getSponsoredDiscount(this.buyBackState,b.offerId,b.discount,c._imeiNumber);f("#deviceBuyBackDiscount").val(parseFloat(b.discount));f("#deviceSponsorDiscount").val(parseFloat(a));var d=g.getMaxDiagnosticsDiscount(this.buyBackState,c._imeiNumber),h;0===d||1>parseFloat(d.MaximumDiagnosticDiscount)?(h=parseFloat(b.discount)+parseFloat(a),b=parseFloat(this.buyBackState.productPrice)-(parseFloat(b.discount)+
parseFloat(a)),g.hide("autoDiagnosticsIngressRunDiagnosticText")):null!==d.DisplayableDiagnosticDiscount&&0!==parseFloat(d.DisplayableDiagnosticDiscount,10)?(h=parseFloat(b.discount)+parseFloat(a)+parseFloat(d.DisplayableDiagnosticDiscount),b=parseFloat(this.buyBackState.productPrice)-(parseFloat(b.discount)+parseFloat(a)+parseFloat(d.DisplayableDiagnosticDiscount)),f("#diagnosticsDiscountsReceivedValue").text(d.DisplayableDiagnosticDiscount),g.showInline("diagnosticsDiscountsReceivedText","diagnosticsDiscountsReceivedValue"),
f("#maxDisplayedDiscountValue").val(d.MaximumDiagnosticDiscount),g.hide("autoDiagnosticsIngressRunDiagnosticText"),g.show("autoDiagnosticsIngressRunAgainText")):(h=parseFloat(b.discount)+parseFloat(a),b=parseFloat(this.buyBackState.productPrice)-(parseFloat(b.discount)+parseFloat(a)),g.showInline("getAdditionalDiagnosticsDiscountText","getAdditionalDiscountvalue"),f("#getAdditionalDiscountvalue").text(d.MaximumDiagnosticDiscount),f("#maxDisplayedDiscountValue").val(d.MaximumDiagnosticDiscount));0!==
parseFloat(a)&&(f("#mdSponsoredDiscountValue").text(parseFloat(a)),g.showInline("mdSponsoredDiscountValue"),g.show("mdSponsoredDiscountText"));"T1"===this.buyBackState.convenienceFeeWeblabAllocation&&(this.applyChargeFee(),""!==this.buyBackState.convenienceFee?(a=Number(this.buyBackState.convenienceFee),b+=parseFloat(this.buyBackState.convenienceFee),f("#isBuyBackFee")[0]===m?this.addBuyBackFeeAsDigitalToBuyBackForm():this.setCustomKeyValueForFeeAsin(),!0===this.buyBackState.dpFeeStringTextEnabled&&
(g.show("buyBackConvenienceFeeTextSection"),f("#buyBackConvenienceFeeTextSection #convenienceFeeCharge").text(a),"T1"!==this.buyBackState.soppWeblabTreatment&&"T2"!==this.buyBackState.soppWeblabTreatment||this.buyBackState.dflEligible||(g.show("buyBackConvenienceFeeTextSectionForSOPP","mdBuyBackConvenienceFeeTextSectionForSOPP"),f("#buyBackConvenienceFeeTextSectionForSOPP #convenienceFeeCharge").text(a),f("#mdBuyBackConvenienceFeeTextSectionForSOPP #convenienceFeeCharge").text(a)))):this.resetFeeFormParams());
this.buyBackState.deviceTotalDiscount=h;n._buyBackState=this.buyBackState;g.show("autoDiagnosticsIngress");f("#mdTotalDiscountValue").text(h);g.showInline("mdTotalDiscountCurrency","mdTotalDiscountValue");f("#priceAfterBuyBackDiscount").text(g.getFormattedPrice(b));g.hide("maxBuyBackDiscountSection");g.show("priceAfterBuyBackDiscountSection");p("#buyBackBuyNowButton").enable();g.show("buyBackConfirmButton")},addBuyBackFeeAsDigitalToBuyBackForm:function(){f("#buyBackBuyNow").append('\x3cinput type\x3d"hidden" id\x3d"isBuyBackKey" name\x3d"custom-name.2.1" value\x3d"UNIQ-buyBack"\x3e\x3cinput type\x3d"hidden" id\x3d"isBuyBackFee" name\x3d"custom-value.2.1" value\x3d"BuyBackFee"\x3e')},
setCustomKeyValueForFeeAsin:function(){f("#isBuyBackKey").val("UNIQ-buyBack");f("#isBuyBackFee").val("BuyBackFee")},resetFeeFormParams:function(){f("#isBuyBackKey")[0]!==m&&f("#isBuyBackKey")[0].value!==m&&f("#isBuyBackKey").val("");f("#isBuyBackFee")[0]!==m&&f("#isBuyBackFee")[0].value!==m&&f("#isBuyBackFee").val("")},applyChargeFee:function(){var a=this.buyBackState.buyBackCategory.toLowerCase()+"_mobile";this.buyBackState.convenienceFee="";if(this.buyBackState.feeMap===m)a="BuyBack:mobile:noEntryExistsFor"+
this.buyBackState.buyBackCategory.toLowerCase()+":count",d.increment(a);else if(this.buyBackState.feeMap.map[a]===m)d.increment("BuyBack:mobile:noEntryExistsFor"+a+":count");else if(!0===this.buyBackState.feeMap.map[a].feeEnabled){this.buyBackState.convenienceFee=this.buyBackState.feeMap.map[a].price;f("#feeAsinPrice").val(this.buyBackState.convenienceFee);var c=this.buyBackState.pageLoadAsinList+"|"+this.buyBackState.feeMap.map[a].asin;f("#buyBackBuyNow #a").val(c);a=this.buyBackState.pageLoadOfferingIdList+
"|"+this.buyBackState.feeMap.map[a].offeringId;f("#buyBackBuyNow #oid").val(a);a=this.buyBackState.pageLoadQuantity+"|1";f("#buyBackBuyNow #quantity").val(a)}else d.increment("BuyBack:mobile:feeDisabledFor"+a+":count")},showADRowAfterDiagnostics:function(){k.log("showADRowAfterDiagnostics");f("#brand").text(c._deviceBrandName).removeClass("hide").addClass("show");f("#deviceBrand").val(c._deviceBrandName);f("#model").text(c._deviceModelName).removeClass("hide").addClass("show");f("#deviceModel").val(c._deviceModelName);
f("#imei").val(c._imeiNumber);if(isNaN(this.buyBackState.deviceSponsoredDiscount)||null===this.buyBackState.deviceSponsoredDiscount||""===this.buyBackState.deviceSponsoredDiscount)this.buyBackState.deviceSponsoredDiscount="0.0";var a=parseFloat(this.buyBackState.deviceBuyBackDiscount,10)+parseFloat(this.buyBackState.deviceSponsoredDiscount,10)+parseFloat(this.buyBackState.deviceDiagnosticsDiscount,10);this.buyBackState.deviceTotalDiscount=a;n._buyBackState=this.buyBackState;f("#mdTotalDiscountValue").text(a);
g.showInline("mdTotalDiscountCurrency","mdTotalDiscountValue");f("#diagnosticsDiscountsReceivedValue").text(this.buyBackState.deviceDiagnosticsDiscount);g.showInline("diagnosticsDiscountsReceivedText","diagnosticsDiscountsReceivedValue");a=parseFloat(this.buyBackState.devicePriceAfterDiagnostics,10);if("T1"===this.buyBackState.convenienceFeeWeblabAllocation)if(this.applyChargeFee(),""!==this.buyBackState.convenienceFee){var d=Number(this.buyBackState.convenienceFee),a=a+parseFloat(this.buyBackState.convenienceFee);
f("#isBuyBackFee")[0]===m?this.addBuyBackFeeAsDigitalToBuyBackForm():this.setCustomKeyValueForFeeAsin();!0===this.buyBackState.dpFeeStringTextEnabled&&(g.show("buyBackConvenienceFeeTextSection"),f("#buyBackConvenienceFeeTextSection #convenienceFeeCharge").text(d),"T1"!==this.buyBackState.soppWeblabTreatment&&"T2"!==this.buyBackState.soppWeblabTreatment||this.buyBackState.dflEligible||(g.show("buyBackConvenienceFeeTextSectionForSOPP","mdBuyBackConvenienceFeeTextSectionForSOPP"),f("#buyBackConvenienceFeeTextSectionForSOPP #convenienceFeeCharge").text(d),
f("#mdBuyBackConvenienceFeeTextSectionForSOPP #convenienceFeeCharge").text(d)))}else this.resetFeeFormParams();f("#priceAfterBuyBackDiscount").text(g.getFormattedPrice(a));g.hide("maxBuyBackDiscountSection");g.show("priceAfterBuyBackDiscountSection");a=g.getMaxDiagnosticsDiscount(this.buyBackState,c._imeiNumber);f("#maxDisplayedDiscountValue").val(a.MaximumDiagnosticDiscount);g.hide("autoDiagnosticsIngressRunDiagnosticText");g.show("autoDiagnosticsIngressRunAgainText");p("#buyBackBuyNowButton").enable();
g.show("buyBackConfirmButton")}}});"use strict";q.when("A","ready").register("BBPageState",function(h){h.on("a:pageUpdate",function(){h.trigger("a2i_dpx:buyback:processBBPageState")});return{_buyBackState:null,callBBPageState:!1,init:function(){this._buyBackState=h.state("buyBackPageState")},get:function(){null===this._buyBackState&&this.init();return this._buyBackState},getUpdatedState:function(){var p=h.$("#buyBackAccordionRow").find("script[type\x3da-state]").html();return p?h.$.parseJSON(p):h.state("buyBackPageState")}}});
q.when("A","ready").register("buyBackPageStateStatic",function(h){});"use strict";q.when("A","ready").register("DiagnosticsState",function(h){return{_isPhoneRooted:null,_isAutoDetectSuccessfull:null,_clickedAlready:!1,_ranAutoDetection:!1,_ranPhoneRooted:!1,_imeiNumber:"",_deviceBrandName:"",_deviceModelName:"",_deviceModelId:"",_amazonAppVersion:"",_androidVersion:"",_hiddenRowHTML:"",_lastHiddenElem:null,_shouldRunAutoDetect:!0}});"use strict";q.when("A").register("Logger",function(h){return{_enable:!1,
log:function(h){this._enable&&console.log(h)}}});"use strict";q.when("A","BBPageState","buyBackPageStateStatic").execute(function(h,p){function g(){c(k).unbind("click").click(function(){n||(n=1,c("#bb-warranty-container").append(c(a+" #addToCart #abbWrapper")))});c(a).unbind("click").click(function(){n&&(n=0,1===f.length&&b.before(c("#bb-warranty-container #abbWrapper")))})}function d(){0<c("#withExchangeOffer-accordion").length?(k="#withExchangeOffer-accordion",a="#withoutExchangeOffer-accordion",
f=c(a+" #addToCart").children(".a-section")):(k="#buyBackAccordionRow",a="#newAccordionRow",f=c(a+" #addToCart  #desktop_qualifiedBuyBox").children(".a-section"));b=c(a+" #addToCart #abbWrapper").next()}var n=0,c=h.$,k="",a="",f="",b=null;p.init();p=p.get();p!==m&&"T1"===p.warrantyWeblabTreatment&&!0===p.hasValidBuyBackOffers&&(d(),g(),h.on("a:pageUpdate",function(){n=0;d();g()}))});q.when("A").execute(function(h){function p(){g("#buyBackBuyNowButton").unbind("click").click(function(){var d=g("#buyBackBuyNow"),
h=d.find('input[name\x3d"itemCount"]');0===h.length?d.append('\x3cinput type\x3d"hidden" name\x3d"itemCount" value\x3d"14"\x3e'):h[0].value=14})}var g=h.$;p();h.on("a2i_dpx:buyback:processBBPageState",function(){p()})});"use strict";q.when("A","ready").register("bbg-atc-handler-component",function(h){var p=!1;return{setBbgAddToCartApiCalled:function(g){p=g},isBbgAddToCartApiCalled:function(){return p}}});"use strict";q.when("A","a-checkbox","a-modal","BBPageState","bbMetric","buyBackPageStateStatic").execute(function(h,
p,g,d,n){function c(b,c){b=a("form\x3d[id\x3d"+c+"]");if(0===b.find('input[class^\x3d"bbgInputData"]').length){f=d.getUpdatedState();var g=f.bbgAsin,h=f.bbgAsinOfferingId,k=f.bbgOfferId,p=k+"-"+(new Date).getTime(),n=b.find("input[name^\x3d'offeringID']").length+1,g='\x3cinput class\x3d"bbgInputData-'+c+'" type\x3d"hidden" id\x3d"asin.'+n+'" name\x3d"asin.'+n+'" value\x3d"'+g+'"\x3e\x3cinput class\x3d"bbgInputData-'+c+'" type\x3d"hidden" id\x3d"quantity.'+n+'" name\x3d"quantity.'+n+'" value\x3d"1"\x3e\x3cinput class\x3d"bbgInputData-'+
c+'" type\x3d"hidden" id\x3d"offeringID.'+n+'" name\x3d"offeringID.'+n+'" value\x3d"'+h+'"\x3e',h=n+1,h='\x3cinput class\x3d"bbgInputData-'+c+'" id\x3d"custom-name.'+h+'.1" name\x3d"custom-name.'+h+'.1" value\x3d"itemAssoc" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+c+'" id\x3d"custom-value.'+h+'.1" name\x3d"custom-value.'+h+'.1" value\x3d"'+p+'" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+c+'" id\x3d"custom-name.'+h+'.2" name\x3d"custom-name.'+h+'.2" value\x3d"itemAssocType" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+
c+'" id\x3d"custom-value.'+h+'.2" name\x3d"custom-value.'+h+'.2" value\x3d"BuyBackGuarantee" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+c+'" id\x3d"custom-name.'+h+'.3" name\x3d"custom-name.'+h+'.3" value\x3d"bbgOfferingId" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+c+'" id\x3d"custom-value.'+h+'.3" name\x3d"custom-value.'+h+'.3" value\x3d"'+k+'" type\x3d"hidden"\x3e',m=b.find("input[name^\x3d'custom-name.1.']").length+1;c='\x3cinput class\x3d"bbgInputData-'+c+'" id\x3d"custom-name.1.'+
m+'" name\x3d"custom-name.1.'+m+'" value\x3d"itemAssoc" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+c+'" id\x3d"custom-value.1.'+m+'" name\x3d"custom-value.1.'+m++ +'" value\x3d"'+p+'" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+c+'" id\x3d"custom-name.1.'+m+'" name\x3d"custom-name.1.'+m+'" value\x3d"UNIQ-itemAssoc" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+c+'" id\x3d"custom-value.1.'+m+'" name\x3d"custom-value.1.'+m++ +'" value\x3d"'+p+'" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+
c+'" id\x3d"custom-name.1.'+m+'" name\x3d"custom-name.1.'+m+'" value\x3d"itemAssocType" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+c+'" id\x3d"custom-value.1.'+m+'" name\x3d"custom-value.1.'+m++ +'" value\x3d"BuyBackGuarantee" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+c+'" id\x3d"custom-name.1.'+m+'" name\x3d"custom-name.1.'+m+'" value\x3d"bbgOfferingId" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+c+'" id\x3d"custom-value.1.'+m+'" name\x3d"custom-value.1.'+m++ +
'" value\x3d"'+k+'" type\x3d"hidden"\x3e';c=g+h+c;k=b.find('input[name\x3d"itemCount"]');0===k.length?c+='\x3cinput type\x3d"hidden" name\x3d"itemCount" value\x3d"'+n+'"\x3e':k.value+=1;b.append(c)}}function k(){f=d.getUpdatedState();!0===f.isbbgOfferAvailable&&(a("[id^\x3d'bbg-checkbox-']").unbind("click").click(function(b){this.checked?c(b,this.value):a(".bbgInputData-"+this.value).remove()}).each(function(){this.checked?c(event,this.value):a(".bbgInputData-"+this.value).remove()}),a("[id^\x3d'bbg-addButton-']").unbind("click").click(function(b){c(b,
this.value);var d=p("#bbg-checkbox-"+this.value),f=g.get(a("#bbg-featureDiv-"+this.value));d.check();null!==f&&f.hide();b.preventDefault()}),a("[id^\x3d'bbg-skipButton-']").unbind("click").click(function(b){a(".bbgInputData-"+this.value).remove();var c=p("#bbg-checkbox-"+this.value),d=g.get(a("#bbg-featureDiv-"+this.value));c.uncheck();null!==d&&d.hide();b.preventDefault()}),b.forEach(function(b){a(document).undelegate(b,"click.bbg");!0===f.isbbgOfferAvailable&&a(document).delegate(b,"click.bbg",
{form:b},q)},b))}var a=h.$;d.init();var f=d.get(),b=["#add-to-cart-button","#buy-now-button","#buyBackBuyNowButton"],q=function(b){a(b.data.form).find('input[class^\x3d"bbgInputData"]')&&(n.increment("BuyBackGuarantee:desktop:bbgAdded:count"),n.increment("BuyBackGuarantee:desktop:bbgAdded:count"+b.data.form))};f!==m&&(h.on("a2i_dpx:buyback:processBBPageState",function(){k()}),k())});"use strict";q.when("A","a-button","BBPageState","bbMetric","buyback-util","buyBackPageStateStatic").register("gep-util",
function(h,m,g,d,n){var c=h.$;g.init();h={bbPageState:g.get(),isGEPEligibleCustomer:function(c){return"undefined"===typeof c?this.bbPageState.gepEligibleCustomer:c.gepEligibleCustomer},showGEPInfoDiv:function(c){c.selectedBuyBackOfferData.gepEligibleBrandModel&&(0==c.selectedBuyBackOfferData.discountPrice?this.showGEPDivsWhenRegularExchangeNotPresent():(n.hide("buyBackVerifyIMEIText","buyBackGEPIMEISuccessAlert","buyBackGEPNotEligibleAlert","buyBackGEPSuccessNotes"),n.show("buyBackGEPIMEIInfoAlert"),
d.increment("BuyBack::gepInfoShown:count"),d.increment("BuyBack:GEP:gepEligibleBrandModelSelected:count")))},showGEPDivsWhenRegularExchangeNotPresent:function(){n.hide("priceAfterBuyBackDiscountSection","buyBackOfferAppliedSuccess","buyBackExchangeMightBeEligibleText","buyBackCollectOldProductDetailsText","buyBackVerifyIMEIText","buyBackGEPIMEISuccessAlert","buyBackGEPNotEligibleAlert","buyBackGEPSuccessNotes");n.show("maxBuyBackDiscountSection","buyBackGEPIMEIInfoAlert","buyBackDetailsVerifyText");
d.increment("BuyBack:GEP:brandModelshownWhenExchangeOfferNotPresent:count");d.increment("BuyBack:GEP:gepEligibleBrandModelSelected:count")},showGEPDivPostIMEIValidation:function(g){d.increment("BuyBack:GEP:IMEIVerifiedWithCashify:count");g.discountAppliedText?g.gepSuccessNoteText?(c("#buyBackGEPIMEISuccessAlert span").html(g.discountAppliedText),c("#buyBackGEPSuccessNotes span").html(g.gepSuccessNoteText),n.show("buyBackGEPIMEISuccessAlert","buyBackGEPSuccessNotes"),n.hide("buyBackOfferAppliedSuccess",
"buyBackGEPNotEligibleAlert"),d.increment("BuyBack:GEP:successNoteShown:count")):g.gepFailureNoteText?(d.increment("BuyBack:GEP:gepNotEligible:count"),c("#buyBackGEPNotEligibleAlert").html(g.gepFailureNoteText),n.hide("buyBackGEPIMEISuccessAlert"),n.show("buyBackGEPNotEligibleAlert","buyBackOfferAppliedSuccess")):(d.increment("BuyBack:GEP:EmptySucessAndFailureNote:count"),n.hide("buyBackGEPIMEISuccessAlert","buyBackGEPNotEligibleAlert"),n.show("buyBackOfferAppliedSuccess")):(n.hide("buyBackIMEISection",
"buyBackOfferAppliedSuccessText","buyBackSponsoredDiscountText"),n.show("buyBackExchangeMightBeEligibleText","buyBackOfferAppliedSuccess"),m("#buyBackBuyNowButton").disable(),d.increment("BuyBack:GEP:gepNotEligibleWhenRegularExchangeNotPresent:count"))}};0==c("#buyBackExchangeMightBeEligibleText").length&&0<c("#buyBackOfferAppliedSuccess").length&&c("#buyBackOfferAppliedSuccess").append('\x3cspan id\x3d"buyBackExchangeMightBeEligibleText" class\x3d"a-size-mini hide"\x3e\x3cdiv class\x3d"a-box a-alert-inline a-alert-inline-error a-spacing-top-mini"\x3e\x3cdiv class\x3d"a-box-inner a-alert-container"\x3e\x3ci class\x3d"a-icon a-icon-alert"\x3e\x3c/i\x3e\x3cdiv class\x3d"a-alert-content"\x3e\x3cspan class\x3d"a-size-base"\x3eYour device is not eligible for exchange. Select a different model.\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/span\x3e');
return h});"use strict";q.when("A","bbMetric","ready").register("buyback-suppress-addToCart",function(h,m){var g=h.$;return{hide:function(){g("#addToCart_feature_div").removeClass("show").addClass("hide");m.increment("AddToCartHandler:button:hide:count")},show:function(){g("#addToCart_feature_div").removeClass("hide").addClass("show");m.increment("AddToCartHandler:button:show:count")}}})});
/* ******** */
(function(m){var q=window.AmazonUIPageJS||window.P,w=q._namespace||q.attributeErrors,a=w?w("DetailPageAlohaAssets",""):q;a.guardFatal?a.guardFatal(m)(a,window):a.execute(function(){m(a,window)})})(function(m,q,w){m.when("A","a-modal","a-checkbox","aloha-simplebundle-common","ready").execute(function(a,l,e,c){function d(){a.declarative("show-review-tab","click",function(c){a.$(c.$target).closest(b.AUI_PAGE_ROOT).find(".popoverReviewsTab").click()});a.declarative("add-to-cart","click",function(c){a.$(b.SB_ROOT+
" "+b.SB_BUYBOX_ITEM_CHECKBOX+" "+b.INPUT_TYPE_CHECKBOX).filter(function(){return a.$(this).data("asin")===c.data.asin}).prop("checked",!0).change();a.$("[id^\x3dpopover-simpleBundle-]").each(function(){var b=l.get(a.$(this));b.isActive()&&b.hide()})});a.declarative("focus-image","mouseenter",function(a){var c=a.$target,d=c.parents(b.AUI_PAGE_ROOT);a=a.data;d.find("#productImageMain-"+a.asin).attr("src",a.imageUrl);d.find(".thumbnail-group").removeClass("a-button-selected");d.find("#"+c.prop("name")).addClass("a-button-selected")})}
var b={BUYBOX_ACCORDION:"#buyBoxAccordion",ADD_TO_CART_FORM:"#addToCart, #buyBackBuyNow",ADD_TO_CART_ATTACH_BUTTON:"#add-to-cart-button.attach-dss-atc:button",SESSION_ID:"#session-id",OFFER_LISTING_ID:"#offerListingID, #oid",AUI_MODAL_SCROLLER:".a-modal-scroller",AUI_PAGE_ROOT:"#a-page",INPUT_TYPE_CHECKBOX:"input[type\x3d'checkbox']",BASE_PRODUCT_PRICE:"#base-product-price",BASE_PRODUCT_PRICE_DATA:"base-product-price",SB_ROOT:".showBundleAsins.simpleBundleFeatureContainer",SB_EXPANDED_MODAL_EXPANDER_HEADER_PREFIX:".simple-bundle-item-expand-header-",
SB_EXPANDED_MODAL_EXPANDER_CONTENT_PREFIX:".simple-bundle-item-expander-content-",SB_EXPANDED_MODAL_LINK:".simple-bundle-buybox-expanded-modal-link",SB_EXPANDED_MODAL_ITEM_LINK_PREFIX:".simple-bundle-item-link-",SB_ACCESSORY_ITEM_LINK_PREFIX:".popover-simpleBundle-link-",SB_BUYBOX_ITEM_CHECKBOX:".simple-bundle-buybox-item-checkbox",SB_BUYBOX_CHECKBOX_PREFIX:".simple-bundle-item-",SB_EXPANDED_CHECKBOX_PREFIX:".simple-bundle-modal-item-",SB_EXPANDER_TITLE:".aloha-simple-bundle-expand-header-title"},
k=!1;e=a.debounce(function(){var e=a.$(b.SB_ROOT);if(e.length){var f=a.$(b.ADD_TO_CART_FORM),l=f.find(":submit").length&&f.find(b.OFFER_LISTING_ID).val(),q=a.$(b.ADD_TO_CART_ATTACH_BUTTON),m=q.length;if(l||m){d();var u=c.getSimpleBundlePageState()||{},x=u.expandedBuyboxEnabled,y=u.selectionMode||"SINGLE",n=u.items||[],A=[],D=a.$(b.SESSION_ID).val(),B=e.find(b.SB_EXPANDED_MODAL_LINK),C,r={baseAsin:u.baseAsin,marketplaceId:u.marketPlaceId,baseItemPrice:a.$(b.BASE_PRODUCT_PRICE).data(b.BASE_PRODUCT_PRICE_DATA),
clientType:"aloha-simplebundle-desktop",currencyOfPreferenceSupported:u.currencyOfPreferenceSupported||!1},v=c.createMetricsLogger(r);k||(k=!0,a.defer(function(){v.logNexusImpression(n);v.logImpressionRefTag()}));B.click(function(a){a.originalEvent&&v.logExpandedLink()});n.forEach(function(g,d){function p(){var g=!1;f.click(function(){g=!g});e.find(b.SB_EXPANDED_MODAL_ITEM_LINK_PREFIX+d).click(function(){g||f.click();B.click();C=C||a.$(b.AUI_MODAL_SCROLLER);C.scrollTop(f.offset().top-C.offset().top+
C.scrollTop())})}function t(){var c=e.find(b.SB_EXPANDED_MODAL_EXPANDER_CONTENT_PREFIX+d),t="/gp/product/features/aloha-ppd/udp-ajax-handler/minidp.html?asin\x3d"+g.asin+"\x26marketplaceId\x3d"+u.marketPlaceId+"\x26offerId\x3d"+g.offerListingId+"\x26activeTab\x3d0",p="a:expander:simple-bundle-item-expander-"+d+":toggle",n=a.once(function(){c.load(t,null,function(b,g,d){a.$.trim(c.html())?(c.find(".a-span-last \x3e .a-spacing-top-base").remove(),c.find(".popover-add-to-cart-button").remove(),b=c.find("#a-page \x3e div \x3e div.a-row"),
g=c.find(".popover-in-stock"),g.remove(),g.addClass("aloha-simple-bundle-modal-detailed-info-header-row-text"),b.append(g),g=c.find(".popover-ship-sold-by"),g.remove(),g.addClass("aloha-simple-bundle-modal-detailed-info-header-row-text"),b.append(g),g=c.find(".popover-retail-domain"),g.remove(),b.append(g),b=c.find("#a-page \x3e div \x3e div.a-column.a-span9"),b.removeClass("a-span9"),b.addClass("a-span12")):c.text(u.ajaxFailMsg)})}),B=p+":expand";a.off(B);a.on(B,function(g){v.logItemLink(d);f.find(b.SB_EXPANDER_TITLE).removeClass("aloha-simple-bundle-expand-header-title-truncate");
a.$.trim(c.html())||n()});p+=":collapse";a.off(p);a.on(p,function(a){f.find(b.SB_EXPANDER_TITLE).addClass("aloha-simple-bundle-expand-header-title-truncate")})}var f=e.find(b.SB_EXPANDED_MODAL_EXPANDER_HEADER_PREFIX+d);if(x)p(),t();else{var n=e.find(b.SB_ACCESSORY_ITEM_LINK_PREFIX+d);n.unbind("click.MiniDpClickHandler");n.bind("click.MiniDpClickHandler",function(){v.logItemLink(d);v.logNexusOpenMiniDP(d,g);v.logMiniDPRefTag(d)})}c.setupCheckboxes(A,d,g,u.maxBuyboxItemsDesktop,b.SB_BUYBOX_CHECKBOX_PREFIX+
d+" "+b.INPUT_TYPE_CHECKBOX,b.SB_EXPANDED_CHECKBOX_PREFIX+d+" "+b.INPUT_TYPE_CHECKBOX,b.SB_BUYBOX_CHECKBOX_PREFIX+d,b.SB_EXPANDED_CHECKBOX_PREFIX+d,y)});r=a.$(b.BUYBOX_ACCORDION);r.length?r.children().each(function(){f=a.$(this).find(b.ADD_TO_CART_FORM);var g=f.find(b.ADD_TO_CART_ATTACH_BUTTON),d=g.length,e=f.find(b.SB_ROOT).length,t=f.find(":submit").length&&f.find(b.OFFER_LISTING_ID).val();e&&t&&c.setupAddToCart(f,A,n,v,D,x);d&&c.setupAddToCartForButton(g,A,n,v,D,x,f)}):(l&&c.setupAddToCart(f,A,
n,v,D,x),m&&c.setupAddToCartForButton(q,A,n,v,D,x,f))}else e.hide()}},200);e();a.on("a:pageUpdate",e)});"use strict";m.when("A","a-checkbox","aloha-uatc","aloha-buy-now-integration","aloha-buybox-form-util","aloha-buy-back-integration","abb-buynow-api").register("aloha-simplebundle-common",function(a,l,e,c,d,b,k){function h(b,d){var c=a.$(b);c.change(function(){c.prop("checked",this.checked);var a={asin:c.data("asin"),offeringID:c.data("offeringID"),quantity:c.data("quantity")};this.checked?(k.addFormParams("#buyNow",
a),k.addFormParams("#buyBackBuyNow",a),k.addFormParams("#buyNowCheckout",a)):(k.removeFormParams("#buyNow",a),k.removeFormParams("#buyBackBuyNow",a),k.removeFormParams("#buyNowCheckout",a))});var e=a.$(d);e.length||(e=c);return{$element:c,$container:e,api:l(b),show:function(){e.hasClass(y.AUI_HIDDEN)&&e.removeClass(y.AUI_HIDDEN);e.show()},hide:function(){e.hasClass(y.AUI_HIDDEN)||e.addClass(y.AUI_HIDDEN)},isVisible:function(){return!e.hasClass(y.AUI_HIDDEN)}}}function f(a,b,c){b.forEach(function(b){a.addItem(b.asin,
b.offerListingId,b.quantity);c.logCheckboxSelected(b.index,b.quantity);c.logAddToCartRefTag(b.index)})}function z(a,b,c){var d=[],e=[];b.forEach(function(b,f){var g=a[f];b.api.isChecked()?d.push({asin:g.asin,offerListingId:g.offerListingId,ourPrice:g.ourPrice,ourPriceAmount:g.ourPriceAmount,ourPriceSymbol:g.ourPriceSymbol,ourPriceCode:g.ourPriceCode,index:f,quantity:c}):e.push({asin:g.asin,ourPrice:g.ourPrice,ourPriceAmount:g.ourPriceAmount,ourPriceSymbol:g.ourPriceSymbol,ourPriceCode:g.ourPriceCode,
index:f,isVisible:b.isVisible()})});return{selectedLineItems:d,unselectedItems:e}}var w=/[^\d,\.]/g,E=/,/g,u=/\./g,x=/(^\D+|\D+$)/,y={AUI_HIDDEN:"aok-hidden"};return{createMetricsLogger:function(b){function c(b,a){q.ue&&q.ue.count&&q.ue.count("aloha-simplebundle-"+b,a)}function d(){var a;a=b.currencyOfPreferenceSupported?{priceFormatted:b.baseItemPrice,priceDecimal:null,currencySymbol:null}:k(b.baseItemPrice);return{baseAsin:b.baseAsin,baseItemPrice:a.priceFormatted,baseItemCurrencySymbol:a.currencySymbol,
baseItemPriceDecimal:a.priceDecimal,clientType:b.clientType,feature:"abb"}}function e(a,c){q.ue&&q.ue.event&&(a.producerId="atch",a.obfuscatedMarketplaceId=b.marketplaceId,q.ue.event(a,"atch",c,{ssd:!0}))}function f(b){a.ajax("/gp/product/ajax-handlers/reftag.html?ref_\x3d"+b,{method:"get"})}function h(a){return b.currencyOfPreferenceSupported?{priceFormatted:a.ourPrice,priceDecimal:parseFloat(a.ourPriceAmount)||null,currencySymbol:a.ourPriceSymbol}:k(a.ourPrice)}function k(a){a=a||"";var b=a.lastIndexOf(","),
c=a.lastIndexOf("."),d;b>c?(c=u,d=E):(c=E,d=u);(b=a.match(x))&&(b=b[0].trim());c=a.replace(w,"").replace(c,"").replace(d,".");c=parseFloat(c);return{priceFormatted:a,currencySymbol:b,priceDecimal:c}}a.defer(function(){c("view",1)});return{logAddToCart:function(a){c("addtocart",a)},logExpandedLink:function(){c("buybox-expanded-link",1)},logCheckboxSelected:function(a,b){c("checkbox-"+(a+1),b)},logItemLink:function(a){c("link-"+(a+1),1)},logImpressionRefTag:function(){f("dp_atch_abb_i")},logAddToCartRefTag:function(a){f("dp_atch_abb_atc_"+
(a+1))},logMiniDPRefTag:function(a){f("dp_atch_abb_smdp_"+(a+1))},logNexusImpression:function(a){var b=d();b.accessories=a.map(function(a,b){var c=h(a);return{asin:a.asin,displayPosition:b+1,price:c.priceFormatted,currencySymbol:c.currencySymbol,priceDecimal:c.priceDecimal}});e(b,"attach.ABBImpression.5")},logNexusAddBaseToCart:function(a,b,c){var f=d();f.baseQuantity=Number(c);f.accessoriesAdded=a.map(function(a){var b=h(a);return{asin:a.asin,displayPosition:a.index+1,quantity:Number(a.quantity),
price:b.priceFormatted,currencySymbol:b.currencySymbol,priceDecimal:b.priceDecimal}});f.accessoriesNotAdded=b.map(function(a){var b=h(a);return{asin:a.asin,displayPosition:a.index+1,price:b.priceFormatted,currencySymbol:b.currencySymbol,priceDecimal:b.priceDecimal}});e(f,"attach.ABBAddBaseToCart.9")},logNexusOpenMiniDP:function(a,b){var c=h(b),f=d();f.accessoryAsin=b.asin;f.accessoryDisplayPosition=Number(a)+1;f.accessoryPrice=c.priceFormatted;f.accessoryItemCurrencySymbol=c.currencySymbol;f.accessoryItemPriceDecimal=
c.priceDecimal;e(f,"attach.ABBShowMiniDP.4")}}},getSimpleBundlePageState:function(){var b=a.$(".simpleBundleJavascriptParameters").find("script").html();return a.parseJSON(b)},getCheckboxCollectionObject:h,setupAddToCart:function(d,h,k,l,m){function r(d,p){if(v){var t=a.$(d.currentTarget);if(c.isBuyNow(t)){var n=g.find("*[name\x3d'quantity']").val()||1,r=z(k,h,n);c.checkoutWith(r.selectedLineItems,t)}else if(b.isBuyBack(t))n=g.find("*[name\x3d'quantity']").val()||1,r=z(k,h,n),b.checkoutWith(r.selectedLineItems,
t);else return}var u=e.createAddToCartRequest(m,function(){p()},function(){q.ueLogError&&q.ueLogError({message:"[There was an error while adding items to the cart using the universal add to cart api.]"},{logLevel:"ERROR",attribution:"SimpleBundle"});p()}),n=g.find("*[name\x3d'quantity']").val()||1,r=z(k,h,n);f(u,r.selectedLineItems,l);t=r.unselectedItems.filter(function(a){return a.isVisible});l.logNexusAddBaseToCart(r.selectedLineItems,t,n);n=u.count();0!==n&&(t=a.$(d.currentTarget),c.isBuyNow(t)?
c.checkoutWith(r.selectedLineItems,t):b.isBuyBack(t)?b.checkoutWith(r.selectedLineItems,t):(v=!0,d.preventDefault(),l.logAddToCart(n),u.call()))}var v=!1,g=d;d.unbind("submit.SimpleBundleSubmitHandler");d.bind("submit.SimpleBundleSubmitHandler",function(b){var c=a.$(this);r(b,function(){c.submit()})});d.find(":submit").unbind("click.SBB");d.find(":submit").bind("click.SBB",function(b){var c=a.$(this),e=c.closest(".a-accordion-row-container");e.length&&(g=e,"addToCart"!==d.attr("id")&&"buyNow"!==d.attr("id")||
d.unbind("submit.SimpleBundleSubmitHandler"),r(b,function(){c.click()}))})},setupAddToCartForDeclarative:function(a,b,c,d,h,k){a.unbind("click.SimpleBundleClickHandler");a.bind("click.SimpleBundleClickHandler",function(a){a=e.createAddToCartRequest(h,function(){m.now("attach-external-atc-interceptor").execute(function(a){a&&l.selectedLineItems.forEach(function(b){a.updateAttachModule(b.asin)})})},function(){q.ueLogError&&q.ueLogError({message:"[There was an error while adding items to the cart using the universal add to cart api.]"},
{logLevel:"ERROR",attribution:"SimpleBundle"})});var g=k.find("*[name\x3d'quantity']").val()||1,l=z(c,b,g);f(a,l.selectedLineItems,d);var n=l.unselectedItems.filter(function(a){return a.isVisible});d.logNexusAddBaseToCart(l.selectedLineItems,n,g);if(g=a.count())d.logAddToCart(g),a.call()})},setupCheckboxes:function(b,c,d,e,f,k,l,g,m){var p=h(f,l);b.push(p);p.api.enable();p.$element.data("asin",d.asin);p.$element.data("offeringID",d.offerListingId);p.$element.data("quantity",1);a.on("a:dropdown:mobileQuantityDropDown:select",
function(a){p.$element.data("quantity",a.value)});a.on("a2idpx:buyback:discount-price",function(a){p.$element.change()});"SINGLE"===m&&p.$element.change(function(){p.api.isChecked()&&b.forEach(function(a,b){c!==b&&a.api.uncheck()})})},setupAddToCartForButton:function(b,c,e,f,h,k){function l(){var a=g.find("*[name\x3d'quantity']").val()||1,b=z(e,c,a);d.addItems(k,b.selectedLineItems,f);var h=b.unselectedItems.filter(function(a){return a.isVisible});m.now("attach-external-atc-interceptor").execute(function(a){a&&
b.selectedLineItems.forEach(function(b){a.updateAttachModule(b.asin)})});f.logNexusAddBaseToCart(b.selectedLineItems,h,a);f.logAddToCart(b.selectedLineItems.length)}var g=k;b.unbind("click.button.SBB");b.bind("click.button.SBB",function(){var b=a.$(this).closest(".a-accordion-row-container");b.length&&(g=b);l()})}}});m.when("A","ready").register("abb-buynow-api",function(a){var l=function(e){return a.$(e+" \x3e input[name\x3dofferingID]")};return{addFormParams:function(e,c){var d=a.$(e+" \x3e input[name\x3dasin]"),
b=l(e);e=a.$(e+" \x3e input[name\x3dquantity]");if((d=a.$(d))&&0!==d.length&&d.val()&&-1===d.val().indexOf(c.asin)&&a.$(e)&&0!==a.$(e).length&&a.$(e).val()&&a.$(b)&&0!==a.$(b).length&&a.$(b).val()){var k=d.val()+"|"+c.asin,h=a.$(b).val()+"|"+c.offeringID;c=a.$(e).val()+"|"+c.quantity;d.val(k);a.$(b).val(h);a.$(e).val(c)}},removeFormParams:function(e,c){var d=a.$(e+" \x3e input[name\x3dasin]"),b=l(e);e=a.$(e+" \x3e input[name\x3dquantity]");if((d=a.$(d))&&0!==d.length&&d.val()&&-1!==d.val().indexOf(c.asin)&&
a.$(e)&&0!==a.$(e).length&&a.$(e).val()&&a.$(b)&&0!==a.$(b).length&&a.$(b).val()){var k=d.val().split("|");c=k.indexOf(c.asin);k.splice(c,1);d.val(k.join("|"));d=a.$(b).val().split("|");d.splice(c,1);a.$(b).val(d.join("|"));b=a.$(e).val().split("|");b.splice(c,1);a.$(e).val(b.join("|"))}}}});"use strict";m.when("A").register("aloha-uatc",function(a){function l(e,c,d,b,k){var h=0;k=k||5E3;b=b||d;var f={clientName:"AmazonWireless"};f.verificationSessionID=e;return{count:function(){return h},call:function(){h&&
a.post("/gp/add-to-cart/json",{timeout:k,params:f,success:c,error:d,abort:b})},addItem:function(a,b,c){f["ASIN."+h]=a;f["offerListingID."+h]=b;f["quantity."+h]=c||1;h++}}}return{createAddToCartRequest:l,createSingleFinalCallbackAddToCartRequest:function(a,c){return l(a,c,c,c)}}});"use strict";m.when("A").register("aloha-buy-now-integration",function(a){var l=a.$,e={};m.when("turbo-checkout-buy-now-integration").execute(function(a){e=a});return{isBuyNow:function(a){return 0===Object.entries(e).length&&
e.constructor===Object?"buy-now-button"===a.attr("id")||"addToCart"===a.attr("id"):"function"===typeof e.isBuyNow&&e.isBuyNow(a)||"buy-now-button"===a.attr("id")},checkoutWith:function(a,d){if(0===Object.entries(e).length&&e.constructor===Object){var b;for(b=1;0<d.find('input[name\x3d"asin.'+b+'"]').length||0<d.find('input[name\x3d"offeringID.'+b+'"]').length;)b++;for(var k=[],h=0;h<a.length;h++){var f=a[h];if(f!==w&&f.asin&&f.offerListingId){var m=b,f=[l("\x3cinput /\x3e",{type:"hidden",name:"asin."+
m,value:f.asin}),l("\x3cinput /\x3e",{type:"hidden",name:"offeringID."+m,value:f.offerListingId}),l("\x3cinput /\x3e",{type:"hidden",name:"quantity."+m,value:f.quantity||1})];Array.prototype.push.apply(k,f);b++}else logError('Line item inputs are invalid. Expected "asin" and "offerListingId" keys in object. Customer purchase inputs ignored!',f)}a=d.find('input[name\x3d"itemCount"]');1===a.length?a.val(b):d.append(l("\x3cinput /\x3e",{type:"hidden",name:"itemCount",value:b}));d.append.apply(d,k)}else return e.checkoutWith(a,
d)}}});"use strict";m.when("A").register("aloha-buy-back-integration",function(a){var l=a.$;return{isBuyBack:function(a){return"buyBackBuyNow"===a.attr("id")},checkoutWith:function(a,c){var d;for(d=1;0<c.find('input[name\x3d"asin.'+d+'"]').length||0<c.find('input[name\x3d"offeringID.'+d+'"]').length;)d++;for(var b=[],k=0;k<a.length;k++){var h=a[k];if(h!==w&&h.asin&&h.offerListingId){var f=d,h=[l("\x3cinput /\x3e",{type:"hidden",name:"asin."+f,value:h.asin}),l("\x3cinput /\x3e",{type:"hidden",name:"offeringID."+
f,value:h.offerListingId}),l("\x3cinput /\x3e",{type:"hidden",name:"quantity."+f,value:h.quantity||1})];Array.prototype.push.apply(b,h);d++}else logError('Line item inputs are invalid. Expected "asin" and "offerListingId" keys in object. Customer purchase inputs ignored!',h)}a=c.find('input[name\x3d"itemCount"]');1===a.length?a.val(d):c.append(l("\x3cinput /\x3e",{type:"hidden",name:"itemCount",value:d}));c.append.apply(c,b)}}});"use strict";m.when("A").register("aloha-buybox-form-util",function(a){function l(a){for(var b=
2;0<a.find('input[name\x3d"asin.'+b+'"]').length||0<a.find('input[name\x3d"offeringID.'+b+'"]').length;)b++;return b}function e(c,b){return[a.$("\x3cinput /\x3e",{type:"hidden",name:"asin."+b,value:c.asin,class:"aloha-accessory-form-input"}),a.$("\x3cinput /\x3e",{type:"hidden",name:"offeringID."+b,value:c.offerListingId,class:"aloha-accessory-form-input"}),a.$("\x3cinput /\x3e",{type:"hidden",name:"quantity."+b,value:c.quantity||1,class:"aloha-accessory-form-input"})]}var c=[];a.on("aloha:detailPage:reappear",
function(){c=[];a.$(".aloha-accessory-form-input").remove()});return{addItems:function(a,b,k){var h=l(a);b.forEach(function(b){if(b!==w&&b.asin&&b.offerListingId){var l=e(b,h);l.forEach(function(b){a.append(b)});c.push(l);h++;k&&(k.logCheckboxSelected(b.index,b.quantity),k.logAddToCartRefTag(b.index))}});b=a.find('input[name\x3d"itemCount"]');0===b.length?a.append('\x3cinput type\x3d"hidden" name\x3d"itemCount" value\x3d"'+h+'"\x3e'):b[0].value=h}}})});
/* ******** */
